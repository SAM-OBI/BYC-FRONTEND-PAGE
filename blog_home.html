<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BYC PROJECT</title>
    <!-- bootstrap cdn  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <link rel="shortcut icon" href="./images/BYC LOGO JPG FILE 1.png" type="image/x-icon">

    <!-- font awesome cdn  -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body onload="checkLoginStatus(),loadSingleBlog(),loadMoreBlogs()">
     <nav class="navbar navbar-expand-lg mb-5 mb-lg-5 pb-lg-5">
        <div class="container-fluid mt-2"> 
              <!-- Left UL LI -->
                <div class="d-none d-lg-flex">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item"><a class="nav-link font-seog" href="./allProducts.html">Shop Products</a></li>
                        <li class="nav-item"><a class="nav-link" href="./blog.html">Blog</a></li>
                        <li class="nav-item"><a class="nav-link" href="./blog_home.html">FAQ</a></li>
                    </ul>
                </div> 

            <!-- BYC LOGO (Center) -->
             <a class="navbar-brand mx-lg-auto" href="./index.html">
              <img src="./images/BYC LOGO JPG FILE 1.png" alt="BYC Logo">
            </a> 

            <!-- Right Menu -->
            <div class="d-none d-lg-flex align-items-center">
              <ul class="navbar-nav">
                  <li class="nav-item "><a class="nav-link" href="./aboutUs.html">About Us</a></li>
                  <li class="nav-item mx-lg-1"><a class="nav-link" href="./contact.html">Contact</a></li>
              </ul>
              <div class="icon-links d-flex align-items-center ">
                  <a href="#"><i class="fas fa-search mx-lg-3"></i></a>
                  <a href="./signUp.html" ><i class="fa-solid fa-user-plus mx-lg-2" id="loggedOut"></i></a>
                  <a href="" class="user-login" id="loggedIn">
                    <i class="fa-solid fa-user mx-lg-2 " id="loggedIn">
                      <span class="status-dot"></span>
                    </i>
                  </a>
                  <a href="./wishlist.html"><i class="far fa-heart mx-lg-2" id="fa-heart"></i></a>
                  <a href="./cart.html"><i class="fas fa-shopping-cart mx-lg-2"></i></a>
              </div>
            </div>
            <!-- Mobile Toggler -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileMenu">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>

          <!-- Mobile Menu -->
        <div class="collapse navbar-collapse mt-3" id="mobileMenu">
            <ul class="navbar-nav text-start ps-3">
                <li class="nav-item d-lg-none"><a class="nav-link" href="./allProducts.html">Shop Products</a></li>
                <li class="nav-item d-lg-none"><a class="nav-link" href="./blog.html">Blog</a></li>
                <li class="nav-item d-lg-none"><a class="nav-link" href="./blog_home.html">FAQ</a></li>
                <li class="nav-item d-lg-none"><a class="nav-link" href="./aboutUs.html">About Us</a></li>
                <li class="nav-item d-lg-none"><a class="nav-link" href="./contact.html">Contact</a></li>
                <li class="nav-item d-flex justify-content-start  gap-3 mt-1 text-start">
                  <!-- <a href="#" class="d-lg-none"><i class="fas fa-search text-dark"></i></a>
                  <a href="./signUp.html" class="d-lg-none"><i class="fa-solid fa-user-plus mx-lg-2 regIcon"></a>
                  <a href="./wishlist.html" class="d-lg-none"><i class="far fa-heart text-dark"></i></a>
                  <a href="./cart.html" class="d-lg-none"><i class="fas fa-cart-shopping text-dark"></i></a> -->
                  <a href="" class="d-lg-none"><i class="fas fa-search text-dark"></i></a>
                  <a href="./signUp.html" class="d-lg-none"><i class="fa-solid fa-user-plus mx-lg-2 regIcon text-dark" id="loggedOut"></i></a>
                  <a href="" class="user-login" id="loggedIn">
                    <i class="fa-solid fa-user mx-lg-2 " id="loggedIn">
                      <span class="status-dot"></span>
                    </i>
                  </a>
                  <a href="wishlist.html" class="d-lg-none"><i class="far fa-heart text-dark" id="fa-heart"></i></a>
                  <a href="./cart.html" class="d-lg-none"><i class="fas fa-cart-shopping text-dark"></i></a>
                </li>
            </ul>
        </div>
    </nav> 

    <main class="home-blog">

      <!-- breadcrumb here  -->
        <div class="container-fluid px-lg-5  mt-3 pb-lg-3 my-lg-5">
          <nav aria-label="breadcrumb">
              <ul class="breadcrumb" style=" --bs-breadcrumb-divider: '>';">
                <li class="breadcrumb-item "><a href="index.html" class="breadcrumb-item text-decoration-none text-dark">Home</a></li>
                <!-- <li class="breadcrumb-item"><a href="blog.html">blog</a></li> -->
                <li class="breadcrumb-item active" aria-current="page">blog</li>
              </ul>
          </nav>
        </div>

        <!-- Main Single Blog Section -->
        <section class="container my-5">
            <div class="text-center">
          <h1 class="my-3 my-lg-5 pb-lg-5 px-2 text-start text-lg-center homeHeadng">How important are shoes in your style?</h1>
        </div>
            <div id="singleBlog" class="text-center">
                <!-- Blog content will be injected here -->
            </div>
        </section>

        <!-- More Blog News Section -->
        <section class="container my-5 pt-lg-5">
            <h2 class="fw-bold text-center mb-4 my-lg-5 mb-5  py-lg-5">More Blog News</h2>
            <div class="row row-cols-1 row-cols-md-3 g-4" id="moreBlogRow">
                <!-- Cards will be injected here -->
            </div>
            <!-- Pagination -->
            <nav class="mt-4">
                <ul class="pagination justify-content-center" id="moreBlogPagination">
                <!-- Pagination buttons will be injected here -->
                </ul>
            </nav>
        </section>

    </main>


    <footer class=" mt-5 py-4 pb-2 footer-font " style="background-color: #212121;">
        <div class="container pt-lg-5 mt-lg-5 py-md-3 text-light">
            <div class="row foot-row">

                <div class="col-sm-12 col-md-2 mb-4 col-lg-2 mb-md-0 col-a ps-lg-2">
                    <h5 class="text-captalize mb-lg-3">Company Info </h5>
                    <ul class="list-unstyled text-light">
                        <li class="my-2"><a href="#" class="text-light " style="text-decoration: none; ">About Us</a></li>
                        <li><a href="#" class="text-light" style="text-decoration: none;">Affiliate</a></li>
                        <li class="my-2"><a href="#" class="text-light"style="text-decoration: none;">Fashion Blogger</a></li>
                    </ul>
                </div>

                <div class="col-sm-12 col-md-2 mb-4 col-lg- mb-md-0 col-b ps-lg-0">
                    <h5 class="text-captalize mb-lg-3">Help & Support</h5>
                    <ul class="list-unstyled text-light">
                        <li class="my-2"><a href="#" class="text-light " style="text-decoration: none;">Shipping Info</a></li>
                        <li><a href="#" class="text-light" style="text-decoration: none;">Refunds</a></li>
                        <li class="my-2"><a href="#" class="text-light" style="text-decoration: none;">How to Order</a></li>
                        <li><a href="#" class="text-light" style="text-decoration: none;">How to Track</a></li>
                        <li class="my-2"><a href="#" class="text-light" style="text-decoration: none;">Size Guide</a></li>
                    </ul>
                </div>

                <div class="col-sm-12 col-md-5 mb-4 col-lg-4 mb-md-0 col-c  ps-lg-0">
                    <h5 class="text-captalize mb-lg-3">Customer Care</h5>
                    <ul class="list-unstyled">
                        <li class="my-2"><a href="#" class="text-light " style="text-decoration: none;">Contact Us</a></li>
                        <li><a href="#" class="text-light" style="text-decoration: none;">payment Methods</a></li>
                        <li class="my-2"><a href="#" class="text-light"style="text-decoration: none;">Fashion Blogger</a></li>
                        <a href="#"><img src="./images/paypal.png" alt="paypal" style="width: 40px; height: 20px;"></a>
                        <a href="#"><img src="./images/visa.png" class="mx-4 img-fluid my-2" alt="visa" style="width: 40px; height: 20px;"></a>
                        <a href="#"><img src="./images/MasterCard.png" alt="MasterCard" style="width: 40px; height: 20px;"></a>
                        
                    </ul>
                </div>

                <div class="col-sm-12 col-md-3 mb-4 col-lg-3 col-d p-lg-0"> 
                    <h5 class="text-captalize mb-3">Signup For The Latest News</h5>
                    <form class="form">
                        <span class="mail-span mb-3">
                            <input type="email" class="text-start mb-lg-5 contact-mail" placeholder="Enter Email" aria-label="Email">
                            <button class="email-btn" onclick="submitEmail(event)"><i class="fas fa-arrow-right text-light btn-arr"></i></button>
                        </span>
                    </form>

                    <!-- Contact Section -->
                    <div class="contact-info mt-2">
                        <a href="" class="text-decoration-none text-light">
                            <i class="fa-regular fa-envelope fa-xl me-2 mb-4"></i>
                            bycafrica@gmail.com
                        </a>
                        <br>
                        <div class="d-flex align-items-center justify-content-lg-center">
                            <a href="" class="text-decoration-none text-light">
                                <i class="fa-solid fa-phone"></i>
                            </a>
                            <div class="d-flex align-items-center justify-content-center pt-2 flex-colum">
                                <p class="pt-2 ps-3 ps-lg-3">+234810137537:</p>
                                <p class="pt-2">+234905403403</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="text-center text-lg-center mt-5 pt-lg-5">
                <a href="#" class="text-decoration-none">
                    <i class="fa-brands fa-facebook fa-2xl text-dark" ></i>
                </a>
                <a href="#" class="text-decoration-none">
                    <i class="fab fa-instagram fa-2xl text-dark mx-lg-5 mx-3"></i>
                </a>
                <a href="#" class="text-decoration-none">
                    <i class="fab fa-twitter fa-2xl text-dark me-lg-5 me-3"></i>
                </a>
                <a href="#" class="text-decoration-none">
                    <i class="fab fa-youtube fa-2xl text-dark mb-3 mb-lg-4"></i>
                </a>
                <hr style="border: 2px solid #fff; background-color: #fff; box-shadow: #e7e6e63d 0px 3px 8px;">
                <p class="mt-5 copyright">All rights Reserved  copyright bycafrica 2021.</p>
            </div>
            <!-- Footer Content ends here -->
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js" integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK" crossorigin="anonymous"></scrip> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="./js/index.js"></script>
    <script>
  // Truncate helper
  function truncateContent(text, wordLimit) {
    const words = text.split(" ");
    if (words.length <= wordLimit) return text;
    return words.slice(0, wordLimit).join(" ") + "...";
  }
  // 1. Load Single Blog
//   async function loadSingleBlog() {
//     const params = new URLSearchParams(window.location.search);
//     const blogId = params.get("id");
//     if (!blogId) return;
//     try {
//       const res = await fetch(`http://localhost:3001/byc/api/blogs/published/${blogId}`);
//       const blog = await res.json();
//       console.log(blog);
//       // Split content into first part and rest
//       const words = blog.content.split(" ");
//       const intro = words.slice(0, 30).join(" ");
//       const rest = words.slice(30).join(" ");
//       document.getElementById("singleBlog").innerHTML = `
//         <!-- Truncated intro -->
//         <p class="text-muted mb-4">${intro}...</p>
//         <!-- Centered image -->
//         <img src="${blog.blogImage}" alt="Blog image"
//           class="img-fluid my-4 "
//           style="max-height: 500px; object-fit: cover;">
//         <!-- Full remaining content -->
//         <p class="text-dark mt-4" style="line-height:1.8;">${rest}</p>
//       `;
//     } catch (err) {
//       console.error("Error loading single blog:", err);
//     }
//   }
  
  async function loadSingleBlog() {
  const params = new URLSearchParams(window.location.search);
  const blogId = params.get("id");
  if (!blogId) {
    document.getElementById("singleBlog").innerHTML = "<p>No blog ID found in URL.</p>";
    return;
  }
  try {
    const res = await fetch(`http://localhost:3001/byc/api/blogs/published/${blogId}`);
    if (!res.ok) throw new Error("Failed to fetch blog");
    const data = await res.json();
    console.log("Blog data received:", data);
    const blog = data.blog; // :white_check_mark: extract actual blog object
    if (!blog || !blog.content) {
      document.getElementById("singleBlog").innerHTML = "<p>Blog content not available.</p>";
      return;
    }
    // Split into intro + rest
    const words = blog.content.split(" ");
    const intro = words.slice(0, 30).join(" ");
    const rest = words.slice(30).join(" ");
    document.getElementById("singleBlog").innerHTML = `
      <!-- Intro -->
      <p class="text-muted mb-4">${intro}...</p>
      <!-- Centered image (first image in array) -->
      <img src="${Array.isArray(blog.blogImage) ? blog.blogImage[0] : blog.blogImage}"
        alt="Blog image"
        class="img-fluid my-3 my-lg-5 rounded"
        style="max-height: 500px; width: 100%; object-fit: cover;">
      <!-- Rest of the content -->
      <p class="text-dark mt-4" style="line-height:1.8;">${rest}</p>
    `;
  } catch (err) {
    console.error("Error loading single blog:", err);
    document.getElementById("singleBlog").innerHTML = "<p>Error loading blog.</p>";
  }
}
  // 2. Load More Blog News with Pagination
  async function loadMoreBlogs(page = 1, perPage = 3) {
    try {
      const res = await fetch("http://localhost:3001/byc/api/blogs/published");
      const blogs = await res.json();
      // Sort latest first
      const sortedBlogs = blogs.reverse();
      // Pagination
      const totalPages = Math.ceil(sortedBlogs.length / perPage);
      const start = (page - 1) * perPage;
      const paginatedBlogs = sortedBlogs.slice(start, start + perPage);
      // Render cards
      document.getElementById("moreBlogRow").innerHTML = paginatedBlogs.map(blog => `
        <div class="col med">
            <div class="card h-100 border-0 rounded-0">
                <!-- Blog Image -->
                <img src="${blog.blogImage}" class="rounded-0" alt="Blog image" style=" width: 100%; height: 400px; object-fit: cover;">
                <div class="card-body text-start ms-2 midh"  style = "height: 500px;">
                    <!-- Profile & meta -->
                    <div class="d-flex align-items-center my-3 " style ="background-color : #E0E0E0;">
                        <img src="${blog.profileImage}" class=" me-2" width="80" height="80" alt="Profile">
                        
                        <div class="ms-5 d-flex gap-5">
                            <span ><i class="fa-slab-press fa-regular fa-eye ms-lg-3 me-2 me-lg-2"></i> 35</span>
                            <span><i class="fa-regular fa-heart me-2 ms-lg-0 ms-5"></i> 23</span>
                          </div>
                    </div>
                    <div class="d-flex gap-2 mb-5">
                        <small class="fw-bold fs-6">${blog.profileName}</small><br>
                        <small class="text-muted fs-6">.${blog.ownersProfession}</small>
                      </div>
                    <!-- Title -->
                    <h5 class="fw-bold" style="height: 70px;">${truncateContent(blog.title, 8)}</h5>
                    <!-- Content -->
                    <p class="text-muted mb-5" style="height: 90px;">${truncateContent(blog.content, 23)}</p>
                    <!-- Read More -->
                    <a class="btn-tag " href="./blog.html#first-blog" role="button">Read more<i class="fa-solid fa-arrow-right fa-l arrow-btn"></i></a>

                </div>
            </div>
        </div>
      `).join("");
      // Render pagination
      document.getElementById("moreBlogPagination").innerHTML = `
        <li class="page-item ${page === 1 ? 'disabled' : ''}">
          <a class="page-link" href="#" onclick="loadMoreBlogs(${page - 1}, ${perPage})">&laquo;</a>
        </li>
        ${Array.from({ length: totalPages }, (_, i) => `
          <li class="page-item ${i + 1 === page ? 'active' : ''}">
            <a class="page-link" href="#" onclick="loadMoreBlogs(${i + 1}, ${perPage})">${i + 1}</a>
          </li>
        `).join("")}
        <li class="page-item ${page === totalPages ? 'disabled' : ''}">
          <a class="page-link" href="#" onclick="loadMoreBlogs(${page + 1}, ${perPage})">&raquo;</a>
        </li>
      `;
    } catch (err) {
      console.error("Error loading more blogs:", err);
    }
  }

</script>
</body>
</html>